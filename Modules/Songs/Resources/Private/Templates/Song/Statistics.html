<f:layout name="Default"/>

<f:section name="Main">
    <div class="page-header">
        <h1>CCLI Lizenzmeldung</h1>
    </div>
    <a role="button" class="btn btn-primary" href="https://olr.ccli.com/" target="CCLI-OLR-Window">Zum CCLI Online Reporting</a><hr />
    <div class="panel-group" id="acc-plans" xmlns:fx="Peregrinus\Flockr\Core\ViewHelpers">
        <f:for each="{plans}" as="plan">
            <div id="panel_{plan.key}" class="panel panel-default" xmlns:fx="">
                <div class="panel-heading">
                    <h4>
                        <a data-toggle="collapse" data-parent="#acc-plans" href="#panel_{plan.key}_collapse">
                            Lieder f&uuml;r
                            <fx:format.date format="%d.%m.%Y" date="{plan.date}"/>
                        </a>
                    </h4>
                </div>
            </div>
            <div id="panel_{plan.key}_collapse" class="panel-collapse collapse">
                <div class="panel-body">
                    <table class="table">
                        <f:for each="{plan.songs}" as="song">
                            <tr>
                                <td valign="top">
                                    <h3>{song.meta.title -> f:format.raw()}</h3>
                                    <small>{song.units.0 -> f:format.raw()}</small>
                                </td>
                                <td valign="top">{song.meta.ccli}</td>
                                <td valign="top">
                                    <a role="button" class="btn btn-primary" href="https://olr.ccli.com/search/results?SearchTerm={f:if(condition: '{song.meta.ccli}', then: '{song.meta.ccli}', else: '{song.meta.title -> fx:format.urlencode(utf8Encode: 1)}')}"
                                       target="CCLI-OLR-Window">
                                        Melden
                                    </a>
                                </td>
                            </tr>
                        </f:for>
                    </table>
                </div>
            </div>
        </f:for>
    </div>
</f:section>